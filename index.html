<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<title>LWX Blog (SEO Version)</title>
<link href=//cdn.jsdelivr.net rel=dns-prefetch>
<link href=//cdnjs.cloudflare.com rel=dns-prefetch>
<link href=//at.alicdn.com rel=dns-prefetch>
<link href=//fonts.googleapis.com rel=dns-prefetch>
<link href=//fonts.gstatic.com rel=dns-prefetch>
<link href=///disqus.com rel=dns-prefetch>
<link href=//c.disquscdn.com rel=dns-prefetch>
<link href=//www.google-analytics.com rel=dns-prefetch>
<meta name=author content="李维茜">
<meta name=description content="LWX Blog">
<meta name=twitter:card content="summary">
<meta name=twitter:site content="@gohugoio">
<meta name=twitter:title content="LWX Blog (SEO Version)">
<meta name=twitter:description content="LWX Blog">
<meta name=twitter:image content="/images/avatar.png">
<meta property="og:type" content="website">
<meta property="og:title" content="LWX Blog (SEO Version)">
<meta property="og:description" content="LWX Blog">
<meta property="og:url" content="http://lwx.ac.cn/">
<meta property="og:image" content="/images/avatar.png">
<meta name=generator content="Hugo 0.89.2">
<link rel=canonical href=http://lwx.ac.cn/>
<link rel=alternate type=application/rss+xml href=http://lwx.ac.cn/index.xml title="LWX Blog">
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=format-detection content="telephone=no,email=no,adress=no">
<meta http-equiv=cache-control content="no-transform">
<meta name=robots content="index,follow">
<meta name=referrer content="origin-when-cross-origin">
<meta name=google-site-verification content="_moDmnnBNVLBN1rzNxyGUGdPHE20YgbmrtzLIbxaWFc">
<meta name=msvalidate.01 content="22596E34341DD1D17D6022C44647E587">
<meta name=theme-color content="#02b875">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="black">
<meta name=apple-mobile-web-app-title content="LWX Blog">
<meta name=msapplication-tooltip content="LWX Blog">
<meta name=msapplication-navbutton-color content="#02b875">
<meta name=msapplication-TileColor content="#02b875">
<meta name=msapplication-TileImage content="/icons/icon-144x144.png">
<link rel=icon href=http://lwx.ac.cn/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=http://lwx.ac.cn/icons/icon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=http://lwx.ac.cn/icons/icon-32x32.png>
<link rel=icon sizes=192x192 href=http://lwx.ac.cn/icons/icon-192x192.png>
<link rel=apple-touch-icon href=http://lwx.ac.cn/icons/icon-152x152.png>
<link rel=manifest href=http://lwx.ac.cn/manifest.json>
<link rel=preload href=http://lwx.ac.cn/styles/main-rendered.min.css as=style>
<link rel=preload href="https://fonts.googleapis.com/css?family=Lobster" as=style>
<link rel=preload href=http://lwx.ac.cn/images/avatar.png as=image>
<link rel=preload href=http://lwx.ac.cn/images/grey-prism.svg as=image>
<style>body{background:#f4f3f1 url(/images/grey-prism.svg)repeat fixed}</style>
<link rel=stylesheet href=http://lwx.ac.cn/styles/main-rendered.min.css>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lobster"><!--[if lte IE 8]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/videojs-ie8@1.1.2/dist/videojs-ie8.min.js></script><![endif]--><!--[if lte IE 9]><script src=https://cdn.jsdelivr.net/npm/eligrey-classlist-js-polyfill@1.2.20180112/classList.min.js></script><![endif]-->
</head>
<body>
<div class=suspension>
<a role=button aria-label="Go to top" title="Go to top" class="to-top is-hide"><span class="icon icon-up" aria-hidden=true></span></a>
</div>
<header class=site-header>
<a href=http://lwx.ac.cn/><img class=avatar src=http://lwx.ac.cn/images/avatar.png alt=Avatar></a>
<h1 class=title><a href=http://lwx.ac.cn/>LWX Blog</a></h1>
<p class=subtitle>知之为知之，不知为不知</p>
<button class=menu-toggle type=button aria-label="Main Menu" aria-expanded=false tab-index=0>
<span class="icon icon-menu" aria-hidden=true></span>
</button>
<nav class="site-menu collapsed">
<h2 class=offscreen>Main Menu</h2>
<ul class=menu-list>
<li class=menu-item>
<a href=http://lwx.ac.cn/post/tech/tech/>技术文章</a>
</li>
</ul>
</nav>
<nav class="social-menu collapsed">
<h2 class=offscreen>Social Networks</h2>
<ul class=social-list><li class=social-item>
<a href=mailto:1248582385@qq.com title=Email aria-label=Email>
<span class="icon icon-email" aria-hidden=true></span>
</a>
</li><li class=social-item>
<a href=//github.com/LWX124 rel=me title=GitHub aria-label=GitHub>
<span class="icon icon-github" aria-hidden=true></span>
</a>
</li><li class=social-item>
<a href=//weibo.com/%e5%b0%8f%e7%88%b7%e7%88%b1%e7%be%8e%e4%ba%ba rel=me title=Weibo aria-label=Weibo>
<span class="icon icon-weibo" aria-hidden=true></span>
</a>
</li></ul>
</nav>
</header>
<section class="main post-list">
<header class="list-header offscreen">
<h2 class=list-label>All Posts</h2>
</header>
<article class=post-entry>
<header class=post-header>
<h3 class=post-title><a href=http://lwx.ac.cn/post/tech/ios-runtime-messagesend/ class=post-link>iOS Runtime探究系列1 - 消息转发底层原理</a></h3>
<p class=post-meta>@LWX · Feb 17, 2022 · 2 min read</p>
</header>
<img class=post-cover src=http://lwx.ac.cn/images/cover.jpg alt="iOS Runtime探究系列1 - 消息转发底层原理" lazyload=on>
<p class=post-summary>本篇主要通过对ios 底层库 objc（runtime）的探究，浅析OC中消息转发的过程
[TOC]
1. oc 中的方法调用是如何转化成消息的？ 我们熟知的OC中的方法调用是通过方括号的，如下：
[instance1 testMsgSend] 底层是将这种调用方式转化成消息机制了，这一步是依赖于编译器的，接下来我们通过clang的 -rewrite-objc 来看下编译成C++代码的结果。
​ main.m 文件内容
#import &lt;UIKit/UIKit.h> #import "AppDelegate.h" #import "LWXClass.h" int main(int argc, char * argv[]) { NSString * appDelegateClassName; @autoreleasepool { // Setup code that might create autoreleased objects goes here. appDelegateClassName = NSStringFromClass([AppDelegate class]); LWXClass *instance1 = [[LWXClass alloc] init]; [instance1 testMsgSend]; } return UIApplicationMain(argc, argv, nil, appDelegateClassName); } 下面我们通过clang将.m文件编译成C++文件：
xcrun -sdk iphonesimulator clang -rewrite-objc main.</p>
<footer class=post-footer>
<a class=read-more href=http://lwx.ac.cn/post/tech/ios-runtime-messagesend/>Read More →</a>
</footer>
</article>
<article class=post-entry>
<header class=post-header>
<h3 class=post-title><a href=http://lwx.ac.cn/post/tech/tech/ class=post-link>技术文章</a></h3>
<p class=post-meta>@LWX · Dec 7, 2021 · 1 min read</p>
</header>
<p class=post-summary>iOS 相关 iOS Runtime探究系列1 - 消息转发底层原理</p>
<footer class=post-footer>
<a class=read-more href=http://lwx.ac.cn/post/tech/tech/>Read More →</a>
</footer>
</article>
</section>
<footer class=site-footer>
<p>© 2017-2022 LWX Blog</p>
<p>Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> with theme <a href=https://github.com/laozhu/hugo-nuo target=_blank rel=noopener>Nuo</a>.</p>
</footer>
<script src=https://cdn.jsdelivr.net/npm/smooth-scroll@15.0.0/dist/smooth-scroll.min.js></script>
<script src=http://lwx.ac.cn/scripts/index.min.js></script>
<script>'serviceWorker'in navigator&&navigator.serviceWorker.register('/service-worker.js').then(function(){console.log('[ServiceWorker] Registered')})</script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-XXXXXXXX-X','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</body>
</html>